{"name":"PaymentControllerTest.java","path":"service/src/test/java/com/myhome/controllers/PaymentControllerTest.java","content":{"structured":{"description":"","items":[{"id":"6ff6fa08-db8d-45c4-beac-402f8a02f3ee","ancestors":[],"type":"function","name":"init","location":{"offset":" ","indent":2,"insert":102,"start":102},"returns":false,"params":[],"code":"@BeforeEach\n  private void init() {\n    MockitoAnnotations.initMocks(this);\n  }","skip":false,"length":4,"comment":{"description":"initializes mocks for the current test class using MockitoAnnotations.","params":[],"returns":null}},{"id":"02c11a01-b525-405e-8045-5a2fe99b1e8a","ancestors":[],"type":"function","name":"createTestPaymentDto","location":{"offset":" ","indent":2,"insert":107,"start":107},"returns":"PaymentDto","params":[],"code":"private PaymentDto createTestPaymentDto() {\n    UserDto userDto = UserDto.builder()\n        .userId(TEST_ADMIN_ID)\n        .communityIds(new HashSet<>(Collections.singletonList(TEST_COMMUNITY_ID)))\n        .id(Long.valueOf(TEST_ADMIN_ID))\n        .encryptedPassword(TEST_ADMIN_PASSWORD)\n        .name(TEST_ADMIN_NAME)\n        .email(TEST_ADMIN_EMAIL)\n        .build();\n    HouseMemberDto houseMemberDto = new HouseMemberDto()\n        .memberId(TEST_MEMBER_ID)\n        .name(TEST_MEMBER_NAME)\n        .id(Long.valueOf(TEST_MEMBER_ID));\n\n    return PaymentDto.builder()\n        .paymentId(TEST_ID)\n        .type(TEST_TYPE)\n        .description(TEST_DESCRIPTION)\n        .charge(TEST_CHARGE)\n        .dueDate(TEST_DUE_DATE)\n        .recurring(TEST_RECURRING)\n        .admin(userDto)\n        .member(houseMemberDto)\n        .build();\n  }","skip":false,"length":25,"comment":{"description":"creates a test payment DTO with fields for payment ID, type, description, charge, due date, recurring status, and the administrators and members details.","params":[],"returns":{"type":"PaymentDto","description":"a PaymentDto object containing mock data for testing purposes."}}},{"id":"f42e2bdd-5f31-44fa-b1d5-d37766612ffd","ancestors":[],"type":"function","name":"createTestCommunityDto","location":{"offset":" ","indent":2,"insert":133,"start":133},"returns":"CommunityDto","params":[],"code":"private CommunityDto createTestCommunityDto() {\n    CommunityDto communityDto = new CommunityDto();\n    communityDto.setName(TEST_COMMUNITY_NAME);\n    communityDto.setDistrict(TEST_COMMUNITY_DISTRICT);\n    communityDto.setCommunityId(TEST_COMMUNITY_ID);\n    return communityDto;\n  }","skip":false,"length":7,"comment":{"description":"creates a new instance of `CommunityDto`.","params":[],"returns":{"type":"CommunityDto","description":"a `CommunityDto` object with predefined values for name, district, and community ID."}}},{"id":"3f5b43fe-424d-4c71-a86a-132e264f5d62","ancestors":[],"type":"function","name":"getMockCommunity","location":{"offset":" ","indent":2,"insert":141,"start":141},"returns":"Community","params":[{"name":"admins","type":"Set<User>"}],"code":"private Community getMockCommunity(Set<User> admins) {\n    Community community =\n        new Community(admins, new HashSet<>(), TEST_COMMUNITY_NAME, TEST_COMMUNITY_ID,\n            TEST_COMMUNITY_DISTRICT, new HashSet<>());\n    User admin = new User(COMMUNITY_ADMIN_NAME, TEST_ADMIN_ID, COMMUNITY_ADMIN_EMAIL, false,\n        COMMUNITY_ADMIN_PASSWORD, new HashSet<>(), new HashSet<>());\n    community.getAdmins().add(admin);\n    admin.getCommunities().add(community);\n\n    CommunityHouse communityHouse = getMockCommunityHouse();\n    communityHouse.setCommunity(community);\n    community.getHouses().add(communityHouse);\n\n    return community;\n  }","skip":false,"length":15,"comment":{"description":"creates a mock Community object with admins, houses and other attributes. It returns the created Community object.","params":[{"name":"admins","type":"Set<User>","description":"set of users who are admins for the generated Community."}],"returns":{"type":"Community","description":"a mock Community object with admins and houses."}}},{"id":"03cee903-7889-43e6-bbf8-9dcb9449c1dc","ancestors":[],"type":"function","name":"getMockCommunityHouse","location":{"offset":" ","indent":2,"insert":157,"start":157},"returns":"CommunityHouse","params":[],"code":"private CommunityHouse getMockCommunityHouse() {\n    CommunityHouse communityHouse = new CommunityHouse();\n    communityHouse.setName(COMMUNITY_HOUSE_NAME);\n    communityHouse.setHouseId(COMMUNITY_HOUSE_ID);\n    communityHouse.setHouseMembers(new HashSet<>());\n\n    return communityHouse;\n  }","skip":false,"length":8,"comment":{"description":"creates a new instance of `CommunityHouse`, setting its name, house ID, and initializing its member set to an empty `HashSet`.","params":[],"returns":{"type":"CommunityHouse","description":"a `CommunityHouse` object with pre-defined properties."}}},{"id":"50dfb5fc-fa6d-49c7-9538-a2c520e3dbcf","ancestors":[],"type":"function","name":"getMockPayment","location":{"offset":" ","indent":2,"insert":166,"start":166},"returns":"Payment","params":[],"code":"private Payment getMockPayment() {\n    User admin =\n        new User(TEST_ADMIN_NAME, TEST_ADMIN_ID, TEST_ADMIN_EMAIL, false, TEST_ADMIN_PASSWORD,\n            new HashSet<>(), new HashSet<>());\n    Community community = getMockCommunity(new HashSet<>());\n    community.getAdmins().add(admin);\n    admin.getCommunities().add(community);\n    return new Payment(TEST_ID, TEST_CHARGE, TEST_TYPE, TEST_DESCRIPTION, TEST_RECURRING,\n        LocalDate.parse(TEST_DUE_DATE, DateTimeFormatter.ofPattern(\"yyyy-MM-dd\")), admin,\n        new HouseMember(TEST_MEMBER_ID, new HouseMemberDocument(), TEST_MEMBER_NAME,\n            new CommunityHouse()));\n  }","skip":false,"length":12,"comment":{"description":"creates a mock Payment object with test data including ID, charge amount, payment type, description, recurring status, due date, and admin and member information.","params":[],"returns":{"type":"Payment","description":"a mock payment object containing various fields representing a fictional payment."}}},{"id":"4561419d-c577-46d4-8689-6a6c6f2c8feb","ancestors":[],"type":"function","name":"shouldSchedulePaymentSuccessful","location":{"offset":" ","indent":2,"insert":179,"start":179},"returns":false,"params":[],"code":"@Test\n  void shouldSchedulePaymentSuccessful() {\n    // given\n    com.myhome.model.SchedulePaymentRequest request =\n        new com.myhome.model.SchedulePaymentRequest()\n            .type(TEST_TYPE)\n            .description(TEST_DESCRIPTION)\n            .recurring(TEST_RECURRING)\n            .charge(TEST_CHARGE)\n            .dueDate(TEST_DUE_DATE)\n            .adminId(TEST_ADMIN_ID)\n            .memberId(TEST_MEMBER_ID);\n\n    EnrichedSchedulePaymentRequest enrichedRequest =\n        new EnrichedSchedulePaymentRequest(TEST_TYPE, TEST_DESCRIPTION, TEST_RECURRING, TEST_CHARGE,\n            TEST_DUE_DATE, TEST_ADMIN_ID, 1L, TEST_ADMIN_NAME, TEST_ADMIN_EMAIL,\n            TEST_ADMIN_PASSWORD, new HashSet<>(Collections.singletonList(TEST_COMMUNITY_ID)),\n            TEST_MEMBER_ID,\n            2L, \"\", TEST_MEMBER_NAME, COMMUNITY_HOUSE_ID);\n    PaymentDto paymentDto = createTestPaymentDto();\n    com.myhome.model.SchedulePaymentResponse response =\n        new com.myhome.model.SchedulePaymentResponse()\n            .paymentId(TEST_ID)\n            .charge(TEST_CHARGE)\n            .type(TEST_TYPE)\n            .description(TEST_DESCRIPTION)\n            .recurring(TEST_RECURRING)\n            .dueDate(TEST_DUE_DATE)\n            .adminId(TEST_ADMIN_ID)\n            .memberId(TEST_MEMBER_ID);\n\n    Community community = getMockCommunity(new HashSet<>());\n\n    HouseMember member = new HouseMember(TEST_MEMBER_ID, null, TEST_MEMBER_NAME,\n        community.getHouses().iterator().next());\n\n    community.getHouses().iterator().next().getHouseMembers().add(member);\n\n    User admin = community.getAdmins().iterator().next();\n\n    given(paymentApiMapper.enrichSchedulePaymentRequest(request, admin, member))\n        .willReturn(enrichedRequest);\n    given(paymentApiMapper.enrichedSchedulePaymentRequestToPaymentDto(enrichedRequest))\n        .willReturn(paymentDto);\n    given(paymentService.schedulePayment(paymentDto))\n        .willReturn(paymentDto);\n    given(paymentApiMapper.paymentToSchedulePaymentResponse(paymentDto))\n        .willReturn(response);\n    given(paymentService.getHouseMember(TEST_MEMBER_ID))\n        .willReturn(Optional.of(member));\n    given(communityService.findCommunityAdminById(TEST_ADMIN_ID))\n        .willReturn(Optional.of(community.getAdmins().iterator().next()));\n\n    //when\n    ResponseEntity<com.myhome.model.SchedulePaymentResponse> responseEntity =\n        paymentController.schedulePayment(request);\n\n    //then\n    assertEquals(HttpStatus.CREATED, responseEntity.getStatusCode());\n    assertEquals(response, responseEntity.getBody());\n    verify(paymentApiMapper).enrichSchedulePaymentRequest(request, admin, member);\n    verify(paymentApiMapper).enrichedSchedulePaymentRequestToPaymentDto(enrichedRequest);\n    verify(paymentService).schedulePayment(paymentDto);\n    verify(paymentApiMapper).paymentToSchedulePaymentResponse(paymentDto);\n    verify(paymentService).getHouseMember(TEST_MEMBER_ID);\n  }","skip":false,"length":66,"comment":{"description":"tests the payment API controller's ability to schedule a payment successfully by enriching the request with additional data, mapping it to a payment dto, and then scheduling the payment using the payment service.","params":[],"returns":null}},{"id":"afbde130-1323-4d9f-bca2-88a4b431fe25","ancestors":[],"type":"function","name":"shouldNotScheduleIfMemberDoesNotExist","location":{"offset":" ","indent":2,"insert":246,"start":246},"returns":false,"params":[],"code":"@Test\n  void shouldNotScheduleIfMemberDoesNotExist() {\n    // given\n    com.myhome.model.SchedulePaymentRequest request =\n        new com.myhome.model.SchedulePaymentRequest()\n            .type(TEST_TYPE)\n            .description(TEST_DESCRIPTION)\n            .recurring(TEST_RECURRING)\n            .charge(TEST_CHARGE)\n            .dueDate(TEST_DUE_DATE)\n            .adminId(TEST_ADMIN_ID)\n            .memberId(TEST_MEMBER_ID);\n    PaymentDto paymentDto = createTestPaymentDto();\n    String expectedExceptionMessage = \"House member with given id not exists: \" + TEST_MEMBER_ID;\n\n    given(paymentApiMapper.schedulePaymentRequestToPaymentDto(request))\n        .willReturn(paymentDto);\n    given(paymentService.schedulePayment(paymentDto))\n        .willReturn(paymentDto);\n    given(paymentService.getHouseMember(TEST_MEMBER_ID))\n        .willReturn(Optional.empty());\n\n    // when\n    final RuntimeException runtimeException =\n        assertThrows(RuntimeException.class, () -> paymentController.schedulePayment(request));\n    // then\n    final String exceptionMessage = runtimeException.getMessage();\n    assertEquals(expectedExceptionMessage, exceptionMessage);\n    verifyNoInteractions(paymentApiMapper);\n  }","skip":false,"length":30,"comment":{"description":"tests that the payment controller will not schedule a payment request if the member associated with the request does not exist.","params":[],"returns":null}},{"id":"2100f0fd-1f86-47b1-8a60-d9fbd737af25","ancestors":[],"type":"function","name":"shouldNotScheduleIfAdminDoesntExist","location":{"offset":" ","indent":2,"insert":277,"start":277},"returns":false,"params":[],"code":"@Test\n  void shouldNotScheduleIfAdminDoesntExist() {\n    // given\n    com.myhome.model.SchedulePaymentRequest request =\n        new com.myhome.model.SchedulePaymentRequest()\n            .type(TEST_TYPE)\n            .description(TEST_DESCRIPTION)\n            .recurring(TEST_RECURRING)\n            .charge(TEST_CHARGE)\n            .dueDate(TEST_DUE_DATE)\n            .adminId(TEST_ADMIN_ID)\n            .memberId(TEST_MEMBER_ID);\n    PaymentDto paymentDto = createTestPaymentDto();\n    String expectedExceptionMessage = \"Admin with given id not exists: \" + TEST_ADMIN_ID;\n    com.myhome.model.SchedulePaymentResponse response =\n        new com.myhome.model.SchedulePaymentResponse()\n            .paymentId(TEST_ID)\n            .charge(TEST_CHARGE)\n            .type(TEST_TYPE)\n            .description(TEST_DESCRIPTION)\n            .recurring(TEST_RECURRING)\n            .dueDate(TEST_DUE_DATE)\n            .adminId(TEST_ADMIN_ID)\n            .memberId(TEST_MEMBER_ID);\n\n    HouseMember member = new HouseMember(TEST_MEMBER_ID, null, TEST_MEMBER_NAME, null);\n\n    given(paymentApiMapper.schedulePaymentRequestToPaymentDto(request))\n        .willReturn(paymentDto);\n    given(paymentService.schedulePayment(paymentDto))\n        .willReturn(paymentDto);\n    given(paymentApiMapper.paymentToSchedulePaymentResponse(paymentDto))\n        .willReturn(response);\n    given(paymentService.getHouseMember(TEST_MEMBER_ID))\n        .willReturn(Optional.of(member));\n    given(communityService.findCommunityAdminById(TEST_ADMIN_ID))\n        .willReturn(Optional.empty());\n\n    // when\n    final RuntimeException runtimeException =\n        assertThrows(RuntimeException.class, () -> paymentController.schedulePayment(request));\n    // then\n    final String exceptionMessage = runtimeException.getMessage();\n    assertEquals(expectedExceptionMessage, exceptionMessage);\n    verifyNoInteractions(paymentApiMapper);\n  }","skip":false,"length":46,"comment":{"description":"tests the payment controller's ability to handle an admin ID that does not exist, by asserting an exception with a specific message when trying to schedule a payment request.","params":[],"returns":null}},{"id":"8f566799-3ca9-431f-8cbe-6da9699958e3","ancestors":[],"type":"function","name":"shouldNotScheduleIfAdminIsNotInCommunity","location":{"offset":" ","indent":2,"insert":324,"start":324},"returns":false,"params":[],"code":"@Test\n  void shouldNotScheduleIfAdminIsNotInCommunity() {\n    // given\n    com.myhome.model.SchedulePaymentRequest request =\n        new com.myhome.model.SchedulePaymentRequest()\n            .type(TEST_TYPE)\n            .description(TEST_DESCRIPTION)\n            .recurring(TEST_RECURRING)\n            .charge(TEST_CHARGE)\n            .dueDate(TEST_DUE_DATE)\n            .adminId(TEST_ADMIN_ID)\n            .memberId(TEST_MEMBER_ID);\n    PaymentDto paymentDto = createTestPaymentDto();\n    com.myhome.model.SchedulePaymentResponse response =\n        new com.myhome.model.SchedulePaymentResponse()\n            .paymentId(TEST_ID)\n            .charge(TEST_CHARGE)\n            .type(TEST_TYPE)\n            .description(TEST_DESCRIPTION)\n            .recurring(TEST_RECURRING)\n            .dueDate(TEST_DUE_DATE)\n            .adminId(TEST_ADMIN_ID)\n            .memberId(TEST_MEMBER_ID);\n\n    Community community = getMockCommunity(new HashSet<>());\n    Set<User> admins = community.getAdmins();\n    User admin = admins.iterator().next();\n    admins.remove(admin);\n\n    CommunityHouse communityHouse = community.getHouses().iterator().next();\n\n    HouseMember member = new HouseMember(TEST_MEMBER_ID, null, TEST_MEMBER_NAME, communityHouse);\n\n    given(paymentApiMapper.schedulePaymentRequestToPaymentDto(request))\n        .willReturn(paymentDto);\n    given(paymentService.schedulePayment(paymentDto))\n        .willReturn(paymentDto);\n    given(paymentApiMapper.paymentToSchedulePaymentResponse(paymentDto))\n        .willReturn(response);\n    given(paymentService.getHouseMember(TEST_MEMBER_ID))\n        .willReturn(Optional.of(member));\n    given(communityService.findCommunityAdminById(TEST_ADMIN_ID))\n        .willReturn(Optional.of(admin));\n\n    //when\n    ResponseEntity<com.myhome.model.SchedulePaymentResponse> responseEntity =\n        paymentController.schedulePayment(request);\n\n    //then\n    assertEquals(HttpStatus.NOT_FOUND, responseEntity.getStatusCode());\n    assertNull(responseEntity.getBody());\n    verify(paymentService).getHouseMember(TEST_MEMBER_ID);\n    verifyNoInteractions(paymentApiMapper);\n    verify(communityService).findCommunityAdminById(TEST_ADMIN_ID);\n  }","skip":false,"length":55,"comment":{"description":"tests that if an admin is not present in the community, the payment will not be scheduled.","params":[],"returns":null}},{"id":"eea1ef59-1cba-400b-a369-9662855ee385","ancestors":[],"type":"function","name":"shouldGetPaymentDetailsSuccess","location":{"offset":" ","indent":2,"insert":380,"start":380},"returns":false,"params":[],"code":"@Test\n  void shouldGetPaymentDetailsSuccess() {\n    // given\n    PaymentDto paymentDto = createTestPaymentDto();\n\n    com.myhome.model.SchedulePaymentResponse expectedResponse =\n        new com.myhome.model.SchedulePaymentResponse()\n            .paymentId(TEST_ID)\n            .charge(TEST_CHARGE)\n            .type(TEST_TYPE)\n            .description(TEST_DESCRIPTION)\n            .recurring(TEST_RECURRING)\n            .dueDate(TEST_DUE_DATE)\n            .adminId(TEST_ADMIN_ID)\n            .memberId(TEST_MEMBER_ID);\n    given(paymentService.getPaymentDetails(TEST_ID))\n        .willReturn(Optional.of(paymentDto));\n    given(paymentApiMapper.paymentToSchedulePaymentResponse(paymentDto))\n        .willReturn(expectedResponse);\n\n    // when\n    ResponseEntity<com.myhome.model.SchedulePaymentResponse> responseEntity =\n        paymentController.listPaymentDetails(TEST_ID);\n\n    // then\n    assertEquals(HttpStatus.OK, responseEntity.getStatusCode());\n    assertEquals(expectedResponse, responseEntity.getBody());\n    verify(paymentService).getPaymentDetails(TEST_ID);\n    verify(paymentApiMapper).paymentToSchedulePaymentResponse(paymentDto);\n  }","skip":false,"length":30,"comment":{"description":"tests the listPaymentDetails method of the PaymentController class by providing a test ID and verifying that the method returns the correct payment details in a ResponseEntity with a status code of OK and the details in the body.","params":[],"returns":null}},{"id":"70b885c9-2106-483a-95dc-125978eb889b","ancestors":[],"type":"function","name":"shouldListNoPaymentDetailsSuccess","location":{"offset":" ","indent":2,"insert":411,"start":411},"returns":false,"params":[],"code":"@Test\n  void shouldListNoPaymentDetailsSuccess() {\n    //given\n    given(paymentService.getPaymentDetails(TEST_ID))\n        .willReturn(Optional.empty());\n\n    //when\n    ResponseEntity<com.myhome.model.SchedulePaymentResponse> responseEntity =\n        paymentController.listPaymentDetails(TEST_ID);\n\n    //then\n    assertEquals(HttpStatus.NOT_FOUND, responseEntity.getStatusCode());\n    assertNull(responseEntity.getBody());\n    verify(paymentService).getPaymentDetails(TEST_ID);\n    verifyNoInteractions(paymentApiMapper);\n  }","skip":false,"length":16,"comment":{"description":"verifies that when no payment details are found for a given ID, the `listPaymentDetails` method of the `paymentController` returns a `HttpStatus.NOT_FOUND` response and an empty `com.myhome.model.SchedulePaymentResponse`.","params":[],"returns":null}},{"id":"6b7ae143-dc42-4f2a-b7fa-d82baf959052","ancestors":[],"type":"function","name":"shouldGetNoMemberPaymentsSuccess","location":{"offset":" ","indent":2,"insert":428,"start":428},"returns":false,"params":[],"code":"@Test\n  void shouldGetNoMemberPaymentsSuccess() {\n    //given\n    given(paymentService.getHouseMember(TEST_MEMBER_ID))\n        .willReturn(Optional.empty());\n\n    //when\n    ResponseEntity<ListMemberPaymentsResponse> responseEntity =\n        paymentController.listAllMemberPayments(TEST_MEMBER_ID);\n\n    //then\n    assertEquals(HttpStatus.NOT_FOUND, responseEntity.getStatusCode());\n    assertNull(responseEntity.getBody());\n    verifyNoInteractions(paymentApiMapper);\n  }","skip":false,"length":15,"comment":{"description":"verifies that the `listAllMemberPayments` method returns a `HttpStatus.NOT_FOUND` response when there are no member payments associated with the given member ID.","params":[],"returns":null}},{"id":"b439d227-a8ec-4099-b667-e390cf4b9912","ancestors":[],"type":"function","name":"shouldGetMemberPaymentsSuccess","location":{"offset":" ","indent":2,"insert":444,"start":444},"returns":false,"params":[],"code":"@Test\n  void shouldGetMemberPaymentsSuccess() {\n    // given\n    PaymentDto paymentDto = createTestPaymentDto();\n\n    given(paymentService.schedulePayment(paymentDto))\n        .willReturn(paymentDto);\n\n    HouseMember member = new HouseMember(TEST_MEMBER_ID, null, TEST_MEMBER_NAME, null);\n    given(paymentService.getHouseMember(TEST_MEMBER_ID))\n        .willReturn(Optional.of(member));\n\n    Set<Payment> payments = new HashSet<>();\n    Payment mockPayment = getMockPayment();\n    payments.add(mockPayment);\n\n    given(paymentService.getPaymentsByMember(TEST_MEMBER_ID))\n        .willReturn(payments);\n\n    Set<MemberPayment> paymentResponses = new HashSet<>();\n    paymentResponses.add(\n        new MemberPayment()\n            .memberId(TEST_MEMBER_ID)\n            .paymentId(TEST_ID)\n            .charge(TEST_CHARGE)\n            .dueDate(TEST_DUE_DATE));\n\n    ListMemberPaymentsResponse expectedResponse =\n        new ListMemberPaymentsResponse().payments(paymentResponses);\n\n    given(paymentApiMapper.memberPaymentSetToRestApiResponseMemberPaymentSet(payments))\n        .willReturn(paymentResponses);\n\n    // when\n    ResponseEntity<ListMemberPaymentsResponse> responseEntity =\n        paymentController.listAllMemberPayments(TEST_MEMBER_ID);\n\n    // then\n    assertEquals(HttpStatus.OK, responseEntity.getStatusCode());\n    assertEquals(responseEntity.getBody(), expectedResponse);\n    verify(paymentService).getPaymentsByMember(TEST_MEMBER_ID);\n    verify(paymentApiMapper).memberPaymentSetToRestApiResponseMemberPaymentSet(payments);\n  }","skip":false,"length":43,"comment":{"description":"tests the listAllMemberPayments endpoint, which retrieves a member's payments from the payment service and maps them to a REST API response.","params":[],"returns":null}},{"id":"ecbe0300-bbd0-49e3-8178-dd4b43b06527","ancestors":[],"type":"function","name":"shouldGetAdminPaymentsSuccess","location":{"offset":" ","indent":2,"insert":488,"start":488},"returns":false,"params":[],"code":"@Test\n  void shouldGetAdminPaymentsSuccess() {\n    // given\n    com.myhome.model.SchedulePaymentRequest request =\n        new com.myhome.model.SchedulePaymentRequest()\n            .type(TEST_TYPE)\n            .description(TEST_DESCRIPTION)\n            .recurring(TEST_RECURRING)\n            .charge(TEST_CHARGE)\n            .dueDate(TEST_DUE_DATE)\n            .adminId(TEST_ADMIN_ID)\n            .memberId(TEST_MEMBER_ID);\n    PaymentDto paymentDto = createTestPaymentDto();\n\n    given(paymentService.schedulePayment(paymentDto))\n        .willReturn(paymentDto);\n\n    List<Payment> payments = new ArrayList<>();\n    Payment mockPayment = getMockPayment();\n    payments.add(mockPayment);\n\n    Set<String> adminIds = new HashSet<>();\n    adminIds.add(TEST_ADMIN_ID);\n\n    Set<User> admins = new HashSet<>();\n\n    Community community = getMockCommunity(admins);\n\n    CommunityDto communityDto = createTestCommunityDto();\n\n    given(communityService.createCommunity(communityDto))\n        .willReturn(community);\n    given(communityService.getCommunityDetailsByIdWithAdmins(TEST_ID))\n        .willReturn(Optional.of(community));\n    given(paymentService.getPaymentsByAdmin(TEST_ADMIN_ID, TEST_PAGEABLE))\n        .willReturn(new PageImpl<>(payments));\n    given(communityService.addAdminsToCommunity(TEST_ID, adminIds))\n        .willReturn(Optional.of(community));\n\n    Set<AdminPayment> responsePayments = new HashSet<>();\n    responsePayments.add(\n        new AdminPayment().adminId(TEST_ADMIN_ID)\n            .paymentId(TEST_ID)\n            .charge(TEST_CHARGE)\n            .dueDate(TEST_DUE_DATE)\n    );\n\n    ListAdminPaymentsResponse expectedResponse =\n        new ListAdminPaymentsResponse()\n            .payments(responsePayments)\n            .pageInfo(PageInfo.of(TEST_PAGEABLE, new PageImpl<>(payments)));\n\n    given(paymentApiMapper.adminPaymentSetToRestApiResponseAdminPaymentSet(new HashSet<>(payments)))\n        .willReturn(responsePayments);\n\n    //when\n    ResponseEntity<ListAdminPaymentsResponse> responseEntity =\n        paymentController.listAllAdminScheduledPayments(TEST_ID, TEST_ADMIN_ID,\n            TEST_PAGEABLE);\n\n    //then\n    assertEquals(HttpStatus.OK, responseEntity.getStatusCode());\n    assertEquals(expectedResponse, responseEntity.getBody());\n    verify(communityService).getCommunityDetailsByIdWithAdmins(TEST_ID);\n    verify(paymentService).getPaymentsByAdmin(TEST_ADMIN_ID, TEST_PAGEABLE);\n    verify(paymentApiMapper).adminPaymentSetToRestApiResponseAdminPaymentSet(\n        new HashSet<>(payments));\n  }","skip":false,"length":68,"comment":{"description":"tests the `ListAllAdminScheduledPayments` endpoint by providing a valid ID and admin ID, retrieving the payments using the provided pageable, and verifying that the response is successful with the expected payments.","params":[],"returns":null}},{"id":"28acb0d1-3b1b-43d9-b4e3-361ced239dc3","ancestors":[],"type":"function","name":"shouldReturnNotFoundWhenAdminIsNotInCommunity","location":{"offset":" ","indent":2,"insert":557,"start":557},"returns":false,"params":[],"code":"@Test\n  void shouldReturnNotFoundWhenAdminIsNotInCommunity() {\n    //given\n    final String notAdminFromCommunity = \"2\";\n    Community community = getMockCommunity(new HashSet<>());\n    given(communityService.getCommunityDetailsByIdWithAdmins(TEST_ID))\n        .willReturn(Optional.of(community));\n\n    //when\n    ResponseEntity<ListAdminPaymentsResponse> responseEntity =\n        paymentController.listAllAdminScheduledPayments(TEST_ID, notAdminFromCommunity,\n            TEST_PAGEABLE);\n\n    //then\n    assertEquals(HttpStatus.NOT_FOUND, responseEntity.getStatusCode());\n    assertNull(responseEntity.getBody());\n    verify(communityService).getCommunityDetailsByIdWithAdmins(TEST_ID);\n    verifyNoInteractions(paymentService);\n  }","skip":false,"length":19,"comment":{"description":"checks that when an admin is not part of a community, the payment controller's `listAllAdminScheduledPayments` method returns a `HttpStatus.NOT_FOUND` response with a null body.","params":[],"returns":null}},{"id":"9cdabd18-d75e-4618-9ae5-3abfe300ce29","ancestors":[],"type":"function","name":"shouldThrowExceptionWhenCommunityNotExists","location":{"offset":" ","indent":2,"insert":577,"start":577},"returns":false,"params":[],"code":"@Test\n  void shouldThrowExceptionWhenCommunityNotExists() {\n    //given\n    String expectedExceptionMessage = \"Community with given id not exists: \" + TEST_ID;\n\n    given(communityService.getCommunityDetailsByIdWithAdmins(TEST_ID))\n        .willReturn(Optional.empty());\n\n    //when\n    final RuntimeException runtimeException = assertThrows(\n        RuntimeException.class,\n        () -> paymentController.listAllAdminScheduledPayments(TEST_ID, TEST_ADMIN_ID,\n            TEST_PAGEABLE)\n    );\n\n    //then\n    assertEquals(expectedExceptionMessage, runtimeException.getMessage());\n    verify(communityService).getCommunityDetailsByIdWithAdmins(TEST_ID);\n    verifyNoInteractions(paymentService);\n    verifyNoInteractions(paymentApiMapper);\n  }","skip":false,"length":21,"comment":{"description":"tests that a RuntimeException is thrown when a community with the given ID does not exist.","params":[],"returns":null}}]}}}